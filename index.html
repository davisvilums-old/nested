<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Nested</title>
<link href="style.css" rel="stylesheet" type="text/css" media="screen" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="jquery.nested.js"></script>
<script src="makeboxes.js"></script>
</head>
<body>

<a class="btn" id="prepend">Prepend</a>

<div id="wrapper">
  <div id="container">
    <div class="box size11 deskbox">Firstdiv Desk</div>
    <div class="size33 mobbox">Firstdiv Mob</div>
    <div class="box size33">2</div>
    <div class="box size32">3</div>
    <div class="box size11">4</div>
    <div class="box size21">5</div>
    <div class="box size12">6</div>
    <div class="box size21">7</div>
    <div class="box size21">7</div>
    <div class="box size11">8</div>
    <div class="box size11">8</div>
    <div class="box size31">9</div>
    <div class="box size31">1</div>
    <div class="box size31">1</div>
    <div class="box size23">2</div>
    <div class="box size32">3</div>
    <div class="box size11">4</div>
    <div class="box size21">5</div>
    <div class="box size12">6</div>
    <div class="box size21">7</div>
    <div class="box size31">9</div>
    <div class="box size22">10</div>
    <div class="box size11">8</div>
    <div class="box size11">8</div>
    <div class="box size11">8</div>
  </div>
</div>

<a class="btn" id="append">Append</a>

<script type="text/javascript" >
  
  $(function() { 
    var Nested_Width = 100;
    var Nested_Gutter = 5;

    resizator(Nested_Width,Nested_Gutter);
    $(window).resize(function(){
      resizator(Nested_Width,Nested_Gutter);
    });
    
    $('#container').nested({
      minWidth: Nested_Width,
      minWidthOrigin: Nested_Width,
      gutter: Nested_Gutter,
      animate: false,
      resizeToFit: false,
      resizeToFitOptions: { resizeAny: false },
      animationOptions: {
        complete: function () {
          isNested = true;
          //resize_modulor();
        }
      }
    });
    
    $('#prepend').click(function(){
      var boxes = makeBoxes();
      $('#container').prepend(boxes).nested('prepend',boxes);
    })
    $('#append').click(function(){
      var boxes = makeBoxes();
      $('#container').append(boxes).nested('append',boxes);     
    })

  });
  var resizator = function(w,g){
    containerw = Math.floor(($(window).width()-g)/(w+g))*(w+g);
    $('#container').width(containerw);
    if(containerw<500){
      $('.deskbox').removeClass('box');
      $('.deskbox').hide();
      $('.mobbox').addClass('box');
    } else {
      $('.mobbox').removeClass('box');
      $('.mobbox').hide();
      $('.deskbox').addClass('box');
    }

  }
  
  
</script>
  
</body>
</html>    